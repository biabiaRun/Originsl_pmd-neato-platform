<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Spectre API Documentation: Spectre API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search-opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Spectre API Documentation"/>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="pmdlogo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Spectre API Documentation
   &#160;<span id="projectnumber">4.7.0.319</span>
   </div>
   <div id="projectbrief">Time-Of-Flight reference implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Spectre API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section warning"><dt>Warning</dt><dd></dd></dl>
<p><b>The major architectural changes in Spectre 4 are not reflected in the documentation. Updates to the documentation are planned for future Spectre 4 releases.</b></p>
<p><a class="anchor" id="api_fig1"></a></p>
<div class="image">
<img src="api_interface.png" alt="api_interface.png"/>
<div class="caption">
Spectre's Public C++ API</div></div>
<p>The Spectre C++ public API is a intented as the single public entry for computing depth data using Spectre. Users of the Spectre C++ public API do not need to use any functions from libcalibration, or configure libprocessing manually, because the API will take care of this. Additionally, it acts as an abstraction layer which hides the differences between platform specific libprocessing implementations. Furthermore, in the future some feature might only be available through C++ API. Therefore, users are encouraged to use the Spectre C++ public API instead of accessing libcalibration / libprocessing directly.</p>
<p>As outlined in the class diagram above, the Spectre public C++ API consists of three main classes in the namespace <code><a class="el" href="namespacespectre.html" title="Contains the public API.">spectre</a></code>:</p>
<ol type="1">
<li>The interface <code><a class="el" href="classspectre_1_1ISpectre.html" title="ISpectre is Spectre&#39;s main entry point, encapsulating calibration handling, and depth-data processing...">spectre::ISpectre</a></code> which is the main entry point of the Spectre public API. An instance of the interface can be obtained through the factory function <code><a class="el" href="namespacespectre.html#ad6a87b732b81c5bffb8bc4644461cd79" title="Creates a new ISpectre instance.">spectre::getSpectre</a></code> which requires the calibration data block as a mandotary argument. Each <code><a class="el" href="classspectre_1_1ISpectre.html" title="ISpectre is Spectre&#39;s main entry point, encapsulating calibration handling, and depth-data processing...">spectre::ISpectre</a></code> instance is coupled with the calibration data block used during its creation.</li>
<li>The <code>Input</code> class which is used to pass the sensor raw input data to Spectre. This class contains only data which (possibly) changes for every raw frame.</li>
<li>The <code>Configuration</code> class which holds the state of Spectre's configuration. A configuration consist of <code><a class="el" href="exceptionspectre_1_1Parameter.html" title="Encapsulation of a parameter which can be used to configure Spectre.">spectre::Parameter</a></code>s and (optional) output redirections. <code><a class="el" href="exceptionspectre_1_1Parameter.html" title="Encapsulation of a parameter which can be used to configure Spectre.">spectre::Parameter</a></code>s allow to configure Spectre's behaviors. Depending on the calibration data, and libprocessing implementation used different sets of parameters are available, which can be queried through the <code>spectre::Configuration</code> instance. Redirection are used to tell Spectre where to store the depth-computation results. If not used, Spectre uses memory managed by Spectre for computation results Each <code>spectre::Configuration</code> instance is coupled to a specific <code><a class="el" href="classspectre_1_1ISpectre.html" title="ISpectre is Spectre&#39;s main entry point, encapsulating calibration handling, and depth-data processing...">spectre::ISpectre</a></code> instance. Use the function <code>ISpectre::configuration()</code> to obtain a copy of the current configuration for modification. You can apply the changed <code>spectre::Configuration</code> instance through <a class="el" href="classspectre_1_1ISpectre.html#accd7b8c7db28d15436388d982f753dea" title="Requests a reconfiguration of the basic parameters of this instance.">spectre::ISpectre::reconfigure</a>.</li>
</ol>
<p>The remaining classes are utility classes which</p>
<ul>
<li>represent a parameter in a configuration (<code><a class="el" href="exceptionspectre_1_1Parameter.html" title="Encapsulation of a parameter which can be used to configure Spectre.">spectre::Parameter</a></code>)</li>
<li>allow to pass existing memory to Spectre (<code>spectre::ArrayReference</code>)</li>
<li>allow to pass memory hold by the instance to Spectre (<code>spectre::ArrayHolder</code>)</li>
</ul>
<p>Their usage should become clear from the example below. For a detailed documentation of the individual API functions, and data structures consult the <code><a class="el" href="namespacespectre.html" title="Contains the public API.">spectre</a></code> namespace documentation.</p>
<h2>Spectre Usage</h2>
<p>The following example code can be used as starting point for computing depth-data from sensor raw data:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;spectre/ISpectre.hpp&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">using namespace </span>spectre;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Initialize this vector with your calibration data</span></div>
<div class="line">    std::vector&lt;uint8_t&gt; calibBlob;</div>
<div class="line">    <a class="code" href="classspectre_1_1ISpectre.html" title="ISpectre is Spectre&#39;s main entry point, encapsulating calibration handling, and depth-data processing...">ISpectre</a> *spectre = <span class="keyword">nullptr</span>;</div>
<div class="line">    <span class="keyword">auto</span> status = <a class="code" href="namespacespectre.html#ad6a87b732b81c5bffb8bc4644461cd79" title="Creates a new ISpectre instance.">getSpectre</a>(ArrayReference&lt;uint8_t&gt;(calibBlob.data(), calibBlob.size()), &amp;spectre);</div>
<div class="line">    <span class="keywordflow">if</span> (status)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Set desired options (e.g., switch to 5 - Phase mode)</span></div>
<div class="line">        <span class="keyword">auto</span> config = spectre-&gt;configuration();</div>
<div class="line">        <span class="keyword">auto</span> numFreqs = config.getParameterByKey(ParameterKey::NUM_FREQUENCIES);</div>
<div class="line">        <span class="keyword">auto</span> freq1 = config.getParameterByKey(ParameterKey::FREQUENCY_1);</div>
<div class="line">        numFreqs.setValue(<a class="code" href="namespacespectre.html#a151a6e42afb546c96052a170514b1828" title="Instantiation of Variant template used for Parameters.">ParameterVariant</a>(static_cast&lt;uint32_t&gt;(1u)));</div>
<div class="line">        <span class="comment">// Set YOUR modulation frequency here</span></div>
<div class="line">        freq1.setValue(<a class="code" href="namespacespectre.html#a151a6e42afb546c96052a170514b1828" title="Instantiation of Variant template used for Parameters.">ParameterVariant</a>(static_cast&lt;uint32_t&gt;(6024000u)));</div>
<div class="line">        <span class="keywordflow">if</span> (!(config.setParameter(numFreqs) &amp;&amp; config.setParameter(freq1) &amp;&amp; spectre-&gt;reconfigure(config)))</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="stringliteral">&quot;Could not reconfigure Spectre&quot;</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Initialize these values with the sensor raw data / exposure times / illumination temperature</span></div>
<div class="line">        std::vector&lt;uint16_t&gt; intensityImage, rawFrame1, rawFrame2, rawFrame3, rawFrame4;</div>
<div class="line">        <span class="keywordtype">unsigned</span> intensityExp = 100u, modExp = 500u;</div>
<div class="line">        <span class="keywordtype">float</span> illuTemp = 30.0f;</div>
<div class="line"></div>
<div class="line">        Input&lt;ArrayReference&gt; input(2u);</div>
<div class="line">        input.setIntensityFrame(ArrayReference&lt;uint16_t&gt;(intensityImage.data(), intensityImage.size()), intensityExp);</div>
<div class="line">        input.setModulatedFrames&lt;ParameterKey::FREQUENCY_1&gt;(ArrayReference&lt;uint16_t&gt;(rawFrame1.data(), rawFrame1.size()),</div>
<div class="line">                                                            ArrayReference&lt;uint16_t&gt;(rawFrame2.data(), rawFrame2.size()),</div>
<div class="line">                                                            ArrayReference&lt;uint16_t&gt;(rawFrame3.data(), rawFrame3.size()),</div>
<div class="line">                                                            ArrayReference&lt;uint16_t&gt;(rawFrame4.data(), rawFrame4.size()),</div>
<div class="line">                                                            modExp);</div>
<div class="line">        input.setTemperature(illuTemp);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (spectre-&gt;processWhole(input))</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// Reference to computed depth-point cloud (x,y,z,c)</span></div>
<div class="line">            <span class="keyword">auto</span> pointCloud = spectre-&gt;results&lt;ResultType::COORDINATES&gt;();</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Do something (e.g., copy to a std::vector)</span></div>
<div class="line">            std::vector&lt;float&gt; xyzc;</div>
<div class="line">            std::copy (pointCloud.cbegin(), pointCloud.cend(), std::back_inserter(xyzc));</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="stringliteral">&quot;Could not process data&quot;</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">delete</span> spectre;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 19 2020 15:57:03 for Spectre API Documentation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
